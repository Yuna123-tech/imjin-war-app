<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>임진왜란 주변 정세 파악 앱</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Noto Sans KR 폰트 임포트 -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
    }
    .animate-pulse-slow {
      animation: pulse 4s infinite cubic-bezier(0.4, 0, 0.6, 1);
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: .5; }
    }
    /* 말풍선 스타일 */
    .speech-bubble-paragraph {
      border-radius: 0.75rem; /* 더 둥근 모서리 */
      padding: 1rem;
      margin-bottom: 0.75rem; /* 말풍선 사이 간격 */
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* 은은한 그림자 */
      line-height: 1.6; /* 줄 간격 */
    }
    .speech-bubble-paragraph:last-child {
      margin-bottom: 0; /* 마지막 말풍선은 하단 마진 없음 */
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React 및 ReactDOM CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- Babel CDN (JSX 변환용) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    // Firebase related global variables are not directly usable in a GitHub Pages environment.
    // However, they are kept for code structure consistency.
    // For actual Firebase integration, separate Firebase project setup and SDK initialization are required.
    // As they are not functionally used here, these declarations are safely maintained.
    const __app_id = 'imjin-war-geopolitics-app'; // Using a fixed value for GitHub
    const __firebase_config = '{}'; // Firebase config not used in this environment
    const __initial_auth_token = null; // Initial auth token not used in this environment


    function App() {
      const [loading, setLoading] = React.useState(false);
      const [geoInfo, setGeoInfo] = React.useState({ japan: [], ming: [] }); // Modified to receive arrays
      const [currentQuizQuestion, setCurrentQuizQuestion] = React.useState(0);
      const [selectedAnswer, setSelectedAnswer] = React.useState(null);
      const [quizFeedback, setQuizFeedback] = React.useState('');
      const [showQuizResult, setShowQuizResult] = React.useState(false);

      // Firebase setup (not directly connected in GitHub Pages)
      const [db, setDb] = React.useState(null);
      const [auth, setAuth] = React.useState(null);
      const [userId, setUserId] = React.useState(null);
      const [isAuthReady, setIsAuthReady] = React.useState(false);

      React.useEffect(() => {
        // In the GitHub Pages environment, Firebase initialization does not directly function.
        // Therefore, dummy data is set to allow the app to run.
        // For actual Firebase integration, Firebase SDK would need to be installed via npm and built.
        console.log("Firebase initialization does not work directly in GitHub Pages environment.");
        setDb({}); // Dummy object
        setAuth({}); // Dummy object
        setUserId('guest-user-github'); // Dummy user ID
        setIsAuthReady(true);

        // Populate geoInfo with static data immediately on component mount
        setGeoInfo({
          japan: [
            "일본은 100년 넘게 여러 영주들이 서로 싸우던 '전국 시대'라는 혼란스러운 시간을 보내고 있었어요. 마치 여러 왕들이 자기 땅을 더 넓히려고 계속 싸우는 시기였죠.",
            "이 긴 싸움을 '도요토미 히데요시'라는 아주 힘세고 똑똑한 장군이 마침내 끝내고 일본을 하나의 나라로 통일했어요. 히데요시는 이제 일본에서 가장 높은 자리에 오르게 되었답니다.",
            "나라를 통일하는 과정에서 많은 병사들이 전쟁만 했기 때문에, 히데요시는 이 병사들의 불만을 잠재우고 새로운 목표를 주고 싶었어요. 또한, 그의 넘치는 힘과 야망을 다른 나라에 보여주고 싶어 했죠.",
            "그래서 히데요시는 아주 큰 꿈을 꾸게 됩니다. 바로 일본을 넘어 중국의 '명나라'까지 정복하는 것이었어요. 당시 명나라는 아시아에서 가장 강력한 나라였답니다.",
            "하지만 일본에서 명나라로 가려면 꼭 조선을 지나가야만 했어요. 히데요시는 조선에 길을 비켜달라고 요구했지만, 조선은 이를 단호히 거절했어요. 조선은 일본이 중국까지 가는 길을 열어주면 자신들도 위험해질 수 있다고 생각했거든요.",
            "조선의 거절에 화가 난 히데요시는 결국 1592년에 대규모 군대를 이끌고 조선을 침략하게 됩니다. 이것이 바로 '임진왜란'의 가장 중요한 시작 이유 중 하나였어요."
          ],
          ming: [
            "명나라는 당시 동아시아에서 가장 크고 오래된 제국이었어요. 중국을 다스리는 아주 강력한 나라였죠. 오랫동안 주변 나라들에게 큰 영향을 미치고 있었답니다.",
            "하지만 명나라는 겉으로는 강해 보였지만, 속으로는 여러 가지 어려운 문제들로 몸살을 앓고 있었어요. 황제들은 나라의 살림을 잘 돌보지 않아 정치가 혼란스러웠고, 높은 관리들 사이에 다툼도 심했어요.",
            "가장 큰 문제는 '재정'이었어요. 나라에 돈이 부족해서 군사들을 제대로 돌보지 못하고, 백성들을 위한 정책도 펼치기 어려웠죠. 게다가 농사를 지을 땅도 부족해지고, 자연재해까지 겹쳐 백성들의 삶이 매우 힘들었어요.",
            "백성들은 먹고살기 힘들어지자 여기저기서 반란을 일으키기 시작했고, 북쪽 국경에서는 '여진족'이라는 새로운 세력이 강해져 명나라를 계속 괴롭혔어요. 바다에서는 '왜구'들이 나타나 마을을 약탈하고 백성들을 힘들게 했죠.",
            "이런 국내외의 많은 문제들을 해결하느라 명나라는 이미 많은 힘과 돈을 쓰고 군사력이 약해지고 있었답니다.",
            "일본이 조선을 침략하자, 명나라는 처음에는 조선을 돕는 것에 대해 고민이 많았어요. 하지만 일본이 조선을 정복하고 더 강해지면, 다음 목표가 바로 명나라 자신이 될 수도 있다고 생각했죠.",
            "그래서 명나라는 자신들의 안전을 지키고, 오랫동안 지켜온 동아시아의 질서를 유지하기 위해 결국 조선을 도와주기로 결정하고 대규모 군대를 조선에 보냈답니다. 명나라가 임진왜란에 참전한 것은 자신들의 나라를 지키기 위한 중요한 선택이었어요."
          ]
        });
      }, []);

      // Quiz data (including questions related to Japan and Ming Dynasty)
      const quizQuestions = [
        {
          question: "임진왜란을 일으킨 일본의 장수는 누구일까요?",
          options: ["도쿠가와 이에야스", "도요토미 히데요시", "오다 노부나가", "시마즈 요시히로"],
          answer: "도요토미 히데요시",
        },
        {
          question: "임진왜란 당시 일본이 조선을 침략하려 했던 가장 큰 이유는 무엇일까요?",
          options: ["조선의 문화를 배우고 싶어서", "명나라를 정복하고 싶어서", "조선과 무역을 하고 싶어서", "농사를 짓기 좋은 땅을 찾아서"],
          answer: "명나라를 정복하고 싶어서",
        },
        {
          question: "임진왜란 당시 조선을 도왔던 나라는 어디일까요?",
          options: ["청나라", "명나라", "몽골", "베트남"],
          answer: "명나라",
        },
        {
          question: "임진왜란 직전 명나라가 가지고 있던 가장 큰 국내 문제는 무엇일까요?",
          options: ["평화로운 시대였다", "돈이 많았다", "농민 반란과 재정 문제가 있었다", "이웃 나라와 사이가 좋았다"],
          answer: "농민 반란과 재정 문제가 있었다",
        },
        {
          question: "명나라는 왜 임진왜란에 참여하여 조선을 도왔을까요?",
          options: ["조선을 아주 좋아해서", "일본이 강해지는 것을 막고 싶어서", "조선의 바다를 차지하고 싶어서", "새로운 친구를 사귀고 싶어서"],
          answer: "일본이 강해지는 것을 막고 싶어서",
        },
        {
          question: "임진왜란 이후 명나라가 겪게 된 가장 큰 어려움은 무엇일까요?",
          options: ["더 부유해졌다", "새로운 영토를 얻었다", "전쟁으로 많은 돈을 써서 나라가 약해졌다", "문화가 발전했다"],
          answer: "전쟁으로 많은 돈을 써서 나라가 약해졌다",
        },
      ];

      const handleAnswerSelect = (option) => {
        setSelectedAnswer(option);
        setQuizFeedback(''); // Clear feedback on answer selection
        setShowQuizResult(false);
      };

      const checkAnswer = () => {
        if (selectedAnswer === null) {
          setQuizFeedback('정답을 선택해주세요!');
          return;
        }
        if (selectedAnswer === quizQuestions[currentQuizQuestion].answer) {
          setQuizFeedback('정답입니다! 🎉');
        } else {
          setQuizFeedback(`오답입니다. 정답은 '${quizQuestions[currentQuizQuestion].answer}' 입니다. 🥲`);
        }
        setShowQuizResult(true);
      };

      const nextQuestion = () => {
        setSelectedAnswer(null);
        setQuizFeedback('');
        setShowQuizResult(false);
        if (currentQuizQuestion < quizQuestions.length - 1) {
          setCurrentQuizQuestion(prev => prev + 1);
        } else {
          setCurrentQuizQuestion(0); // Loop back to the first question if all questions are answered
          setQuizFeedback('모든 퀴즈를 푸셨습니다! 처음부터 다시 시작합니다. ✨');
        }
      };

      return (
        <>
          <div className="min-h-screen bg-gradient-to-br from-blue-100 to-purple-100 flex items-center justify-center p-4">
            <div className="relative bg-white p-8 rounded-xl shadow-2xl max-w-4xl mx-auto border-4 border-purple-500">
              <h1 className="text-4xl font-bold text-gray-800 mb-6 text-center">⚔️ 임진왜란 이전 주변 정세 파악</h1>
              <p className="text-lg text-gray-700 mb-0 text-center">
                임진왜란이 일어나기 직전, 이웃 나라 일본과 명나라는 어떤 상황이었을까요?
              </p>
              <p className="text-lg text-gray-700 mb-6 text-center">
                아래에서 자세한 이야기를 들어봅시다!
              </p>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                  {/* 일본 상황 */}
                  <div className="bg-blue-50 p-6 rounded-xl shadow-md border border-blue-200 flex flex-col">
                    <h3 className="text-2xl font-bold text-blue-800 mb-4 text-center">🇯🇵 일본의 상황</h3>
                    {geoInfo.japan.map((paragraph, index) => (
                      <div key={`jp-bubble-${index}`} className="speech-bubble-paragraph bg-blue-100 border-blue-300">
                        <p className="text-gray-700 leading-relaxed text-base text-justify">
                          {paragraph}
                        </p>
                      </div>
                    ))}
                    <a href="http://contents.nahf.or.kr/id/NAHF.edeao.d_0004_0010_0010" target="_blank" rel="noopener noreferrer"
                       className="mt-auto bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-xl shadow-md transition duration-300 transform hover:scale-105 active:scale-95 text-center block w-full mt-4">
                      더 많은 정보 보러 가기 (동북아역사넷)
                    </a>
                  </div>

                  {/* 명나라 상황 */}
                  <div className="bg-red-50 p-6 rounded-xl shadow-md border border-red-200 flex flex-col">
                    <h3 className="text-2xl font-bold text-red-800 mb-4 text-center">🇨🇳 명나라의 상황</h3>
                    {geoInfo.ming.map((paragraph, index) => (
                      <div key={`mg-bubble-${index}`} className="speech-bubble-paragraph bg-red-100 border-red-300">
                        <p className="text-gray-700 leading-relaxed text-base mb-2 text-justify">
                          {paragraph}
                        </p>
                      </div>
                    ))}
                    <a href="https://archives.warmemo.or.kr:8443/exbi/prmn/exbiPrmnList.do?MID=UM00032&ctgryClfcCd=70" target="_blank" rel="noopener noreferrer"
                       className="mt-auto bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-xl shadow-md transition duration-300 transform hover:scale-105 active:scale-95 text-center block w-full mt-4">
                      더 많은 정보 보러 가기 (전쟁기념관)
                    </a>
                  </div>
              </div>


              {/* 퀴즈 섹션 */}
              <div className="mt-12 p-8 bg-purple-50 rounded-xl shadow-lg border-4 border-purple-300">
                <h2 className="text-3xl font-bold text-purple-700 mb-6 text-center">🧠 역사 퀴즈 풀기!</h2>
                <div className="text-center mb-6">
                  <p className="text-xl font-semibold text-gray-800 mb-4">
                    {quizQuestions[currentQuizQuestion].question}
                  </p>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {quizQuestions[currentQuizQuestion].options.map((option, index) => (
                      <button
                        key={index}
                        onClick={() => handleAnswerSelect(option)}
                        className={`p-3 rounded-lg border-2 ${selectedAnswer === option ? 'bg-blue-200 border-blue-500' : 'bg-gray-100 border-gray-300'} hover:bg-blue-100 transition duration-200`}
                      >
                        {option}
                      </button>
                    ))}
                  </div>
                  <div className="mt-6">
                    <button
                      onClick={checkAnswer}
                      className="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-5 rounded-xl shadow-md transition duration-300 transform hover:scale-105 active:scale-95 mr-4"
                    >
                      정답 확인
                    </button>
                    <button
                      onClick={nextQuestion}
                      className="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-5 rounded-xl shadow-md transition duration-300 transform hover:scale-105 active:scale-95"
                    >
                      다음 문제
                    </button>
                  </div>
                  {showQuizResult && (
                    <p className={`mt-4 text-xl font-bold ${quizFeedback.includes('정답입니다') ? 'text-green-700' : 'text-red-700'}`}>
                      {quizFeedback}
                    </p>
                  )}
                </div>
              </div>

              {isAuthReady && (
                <p className="mt-8 text-sm text-gray-500 text-center">
                  사용자 ID: {userId}
                </p>
              )}
            </div>
          </div>
        </>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
